import time


def max_coalition(A, i):
    max_coalition.values = A
    result = []
    total_max = [0, 0]

    for j in range(i):
        temp = generate_coalitions(j)
        maxValue = [0, 0]
        for e in range(len(temp)):
            if temp[e][1] > maxValue[0]:
                maxValue[0] = temp[e][1]
                maxValue[1] = temp[e][0]

        result.append(maxValue)
        # print(maxValue)

    for j in range(len(result)):
        if result[j][0] > total_max[0]:
            total_max = result[j]
    # print(total_max)
    return total_max


def generate_coalitions(i):
    # generetaring all possible coalitions for step i;

    result = []
    if i <= 1:
        for key in max_coalition.values:
            if len(key) <= i:
                result.append([key, V(key)])

    else:
        for x in max_coalition.values:
            if len(x) == i:
                result.append([x, V(x)])
                temp = x
                # print(x)
                for key in max_coalition.values:
                    # if key in x:#
                    for a in key:
                        counter = 0
                        if a in x:
                            counter += 1
                        if (counter == len(key)) and (len(key) < len(x)):
                            if (V(key) + V(temp.replace(key, ''))) > V(x):
                                # print(max_coalition.values[x])
                                max_coalition.values[x] = (V(key) + V(temp.replace(key, '')))
                                # print(max_coalition.values[x])
                                result.append([key + '+' + temp.replace(key, ''), max_coalition.values[x]])
                                # print(result)
                            else:
                                result.append([key + '+' + temp.replace(key, ''), V(key) + V(temp.replace(key, ''))])
                                # print(result)
    # print(result)
    return result


def V(element):
    # Accepts a as list of elements in one group and looks for its value in dict A;

    return (max_coalition.values[element])


def check_elements():  ##############################################
    simple_elements = 0
    for x in max_coalition.values:
        if len(x) < 2:
            simple_elements += 1

    return simple_elements


# Data example:
# {[f1] : 20,
#  [f2] : 30,
#  [f3] : 10,
#  [f4] : 40,
#  [f1, f2] : 35,
#  [f3, f4] : 30,
#  [f1, f3] : 25,
#  [f2, f4] : 50,
#  [f1, f4] : 40,
#  [f2, f3] : 35,
#  [f1, f2, f3] : 45,
#  [f1, f2, f4] : 75,
#  [f2, f3, f4] : 75,
#  [f1, f3, f4] : 65,
#  [f1, f2, f3, f4] : 65 }
#  max value = 100 for [f1] + [f2] + [f3] + [f4];
#
# ================================================
#
# {[f1] : 20,
#  [f2] : 30,
#  [f3] : 50,
#  [f4] : 10,
#  [f5] : 40,
#  [f1, f2] : 35,
#  [f2, f3] : 55,
#  [f3, f4] : 55,
#  [f4, f5] : 30,
#  [f1, f3] : 45,
#  [f1, f4] : 25,
#  [f1, f5] : 40,
#  [f2, f4] : 35,
#  [f2, f5] : 50,
#  [f3, f5] : 70,
#  [f1, f2, f3] : 135,
#  [f2, f3, f4] : 75,
#  [f3, f4, f5] : 135,
#  [f1, f2, f5] : 115,
#  [f1, f3, f4] : 65,
#  [f1, f3, f5] : 125,
#  [f1, f4, f5] : 105,
#  [f2, f4, f5] : 115,
#  [f2, f3, f5] : 135,
#  [f1, f2, f3, f4] : 140,
#  [f1, f2, f3, f5] : 155,
#  [f1, f2, f4, f5] : 75,
#  [f1, f3, f4, f5] : 85,
#  [f2, f3, f4, f5] : 95,
#  [f1, f2, f3, f4, f5] : 180 }
# mxa value = 185 for [f2] + [f3] + [f1, f4, f5];
#
# ================================================


# {(1,): 59, (2,): 74, (1, 2): 212, (3,): 127, (1, 3): 88, (2, 3): 169, (1, 2, 3): 293, (4,): 41, (1, 4): -6, (2, 4): 28, (1, 2, 4): 250, (3, 4): 75, (1, 3, 4): 297, (2, 3, 4): 189, (1, 2, 3, 4): 189}


# max_coalition({'1': 30, '2': 40, '12': 50, '3': 25, '13': 60, '23': 55, '123': 90, '4': 45, '14': 80, '24': 70, '124': 120, '34': 80, '134': 100, '234': 115, '1234': 140}, 5)


if __name__ == "__main__":
    import time

    start = time.time()

    test = max_coalition(
        {'1': 30, '2': 40, '12': 50, '3': 25, '13': 60, '23': 55, '123': 90, '4': 45, '14': 80, '24': 70, '124': 120,
         '34': 80, '134': 100, '234': 115, '1234': 140}, 5)

    end = time.time()
    print(end - start)

    start = time.time()

    test4 = max_coalition(
        {'1': 38, '2': 98, '12': 186, '3': 172, '13': 126, '23': 361, '123': 420, '4': 41, '14': 5, '24': 210,
         '124': 119, '34': 141, '134': 189, '234': 207, '1234': 397}, 5)

    end = time.time()
    print(end - start)

    start = time.time()

    test5 = max_coalition(
        {'1': 74, '2': 89, '12': 223, '3': 46, '13': 215, '23': 94, '123': 169, '4': 180, '14': 207, '24': 336,
         '124': 278, '34': 162, '134': 376, '234': 381, '1234': 473, '5': 123, '15': 103, '25': 272, '125': 372,
         '35': 77, '135': 133, '235': 187, '1235': 381, '45': 391, '145': 432, '245': 478, '1245': 406, '345': 304,
         '1345': 326, '2345': 357, '12345': 628}, 6
    )

    end = time.time()
    print(end - start)

    start = time.time()

    test6 = max_coalition(
        {'1': 91, '2': 79, '12': 125, '3': 151, '13': 131, '23': 274, '123': 376, '4': 59, '14': 34, '24': 219,
         '124': 111, '34': 147, '134': 389, '234': 199, '1234': 269, '5': 115, '15': 154, '25': 300, '125': 242,
         '35': 191, '135': 246, '235': 251, '1235': 374, '45': 133, '145': 324, '245': 160, '1245': 442, '345': 256,
         '1345': 300, '2345': 313, '12345': 410, '6': 107, '16': 271, '26': 92, '126': 374, '36': 182, '136': 246,
         '236': 448, '1236': 468, '46': 285, '146': 372, '246': 170, '1246': 435, '346': 393, '1346': 473, '2346': 340,
         '12346': 423, '56': 156, '156': 261, '256': 183, '1256': 286, '356': 472, '1356': 564, '2356': 368,
         '12356': 609, '456': 227, '1456': 282, '2456': 259, '12456': 491, '3456': 485, '13456': 475, '23456': 566,
         '123456': 645}, 7
    )

    end = time.time()
    print(end - start)

    start = time.time()

    test7 = max_coalition(
        {'1': 152, '2': 119, '12': 371, '3': 89, '13': 306, '23': 290, '123': 414, '4': 55, '14': 103, '24': 229,
         '124': 405, '34': 234, '134': 232, '234': 307, '1234': 308, '5': 74, '15': 344, '25': 268, '125': 405,
         '35': 68, '135': 217, '235': 378, '1235': 322, '45': 243, '145': 189, '245': 312, '1245': 515, '345': 278,
         '1345': 455, '2345': 295, '12345': 393, '6': 184, '16': 425, '26': 359, '126': 570, '36': 323, '136': 338,
         '236': 472, '1236': 595, '46': 144, '146': 495, '246': 264, '1246': 561, '346': 247, '1346': 389, '2346': 373,
         '12346': 518, '56': 341, '156': 483, '256': 323, '1256': 464, '356': 418, '1356': 580, '2356': 364,
         '12356': 732, '456': 416, '1456': 560, '2456': 480, '12456': 693, '3456': 294, '13456': 609, '23456': 439,
         '123456': 714, '7': 161, '17': 204, '27': 169, '127': 524, '37': 339, '137': 347, '237': 411, '1237': 442,
         '47': 290, '147': 470, '247': 221, '1247': 594, '347': 262, '1347': 549, '2347': 382, '12347': 508, '57': 349,
         '157': 480, '257': 286, '1257': 450, '357': 241, '1357': 404, '2357': 328, '12357': 535, '457': 177,
         '1457': 558, '2457': 313, '12457': 478, '3457': 454, '13457': 434, '23457': 455, '123457': 585, '67': 264,
         '167': 548, '267': 370, '1267': 556, '367': 512, '1367': 543, '2367': 657, '12367': 632, '467': 448,
         '1467': 432, '2467': 591, '12467': 756, '3467': 439, '13467': 547, '23467': 684, '123467': 801, '567': 512,
         '1567': 668, '2567': 490, '12567': 739, '3567': 567, '13567': 608, '23567': 739, '123567': 715, '4567': 389,
         '14567': 715, '24567': 476, '124567': 647, '34567': 612, '134567': 650, '234567': 583, '1234567': 880}, 8
    )

    end = time.time()
    print(end - start)

    start = time.time()

    test8 = max_coalition(
        {'1': 61, '2': 156, '12': 113, '3': 46, '13': -9, '23': 318, '123': 373, '4': 152, '14': 95, '24': 197,
         '124': 251, '34': 102, '134': 146, '234': 403, '1234': 335, '5': 128, '15': 297, '25': 377, '125': 408,
         '35': 243, '135': 279, '235': 238, '1235': 504, '45': 338, '145': 390, '245': 519, '1245': 581, '345': 245,
         '1345': 347, '2345': 439, '12345': 490, '6': 149, '16': 170, '26': 385, '126': 453, '36': 311, '136': 318,
         '236': 465, '1236': 527, '46': 389, '146': 424, '246': 539, '1246': 464, '346': 467, '1346': 305, '2346': 598,
         '12346': 477, '56': 198, '156': 290, '256': 371, '1256': 414, '356': 281, '1356': 273, '2356': 599,
         '12356': 493, '456': 358, '1456': 553, '2456': 650, '12456': 603, '3456': 579, '13456': 577, '23456': 728,
         '123456': 592, '7': 49, '17': 228, '27': 288, '127': 344, '37': 212, '137': 80, '237': 194, '1237': 409,
         '47': 278, '147': 152, '247': 467, '1247': 333, '347': 156, '1347': 257, '2347': 346, '12347': 572, '57': 70,
         '157': 181, '257': 424, '1257': 444, '357': 158, '1357': 324, '2357': 487, '12357': 389, '457': 210,
         '1457': 343, '2457': 407, '12457': 661, '3457': 306, '13457': 319, '23457': 578, '123457': 650, '67': 243,
         '167': 142, '267': 432, '1267': 345, '367': 185, '1367': 406, '2367': 335, '12367': 381, '467': 451,
         '1467': 332, '2467': 587, '12467': 500, '3467': 441, '13467': 376, '23467': 655, '123467': 699, '567': 282,
         '1567': 440, '2567': 539, '12567': 447, '3567': 463, '13567': 540, '23567': 604, '123567': 692, '4567': 530,
         '14567': 646, '24567': 560, '124567': 599, '34567': 621, '134567': 490, '234567': 771, '1234567': 797, '8': 87,
         '18': 232, '28': 129, '128': 344, '38': 25, '138': 106, '238': 361, '1238': 465, '48': 182, '148': 404,
         '248': 289, '1248': 529, '348': 371, '1348': 392, '2348': 342, '12348': 554, '58': 281, '158': 394, '258': 456,
         '1258': 516, '358': 375, '1358': 390, '2358': 479, '12358': 388, '458': 471, '1458': 367, '2458': 613,
         '12458': 478, '3458': 522, '13458': 546, '23458': 645, '123458': 587, '68': 295, '168': 208, '268': 479,
         '1268': 537, '368': 327, '1368': 289, '2368': 489, '12368': 560, '468': 309, '1468': 536, '2468': 631,
         '12468': 656, '3468': 388, '13468': 565, '23468': 644, '123468': 746, '568': 441, '1568': 465, '2568': 423,
         '12568': 521, '3568': 520, '13568': 569, '23568': 464, '123568': 544, '4568': 564, '14568': 458, '24568': 763,
         '124568': 665, '34568': 452, '134568': 709, '234568': 786, '1234568': 831, '78': 194, '178': 265, '278': 236,
         '1278': 277, '378': 266, '1378': 162, '2378': 447, '12378': 515, '478': 180, '1478': 464, '2478': 347,
         '12478': 581, '3478': 407, '13478': 493, '23478': 603, '123478': 651, '578': 219, '1578': 420, '2578': 537,
         '12578': 374, '3578': 269, '13578': 481, '23578': 516, '123578': 638, '4578': 333, '14578': 574, '24578': 655,
         '124578': 743, '34578': 369, '134578': 472, '234578': 716, '1234578': 584, '678': 389, '1678': 391,
         '2678': 509, '12678': 603, '3678': 247, '13678': 488, '23678': 583, '123678': 656, '4678': 353, '14678': 598,
         '24678': 521, '124678': 739, '34678': 524, '134678': 427, '234678': 571, '1234678': 642, '5678': 518,
         '15678': 543, '25678': 652, '125678': 721, '35678': 400, '135678': 570, '235678': 528, '1235678': 577,
         '45678': 669, '145678': 532, '245678': 654, '1245678': 672, '345678': 712, '1345678': 772, '2345678': 714,
         '12345678': 911}, 9
    )

    end = time.time()
    print(end - start)

    start = time.time()

    test9 = max_coalition(
        {'1': 125, '2': 80, '12': 285, '3': 109, '13': 173, '23': 240, '123': 366, '4': 159, '14': 388, '24': 175,
         '124': 273, '34': 220, '134': 290, '234': 252, '1234': 424, '5': 118, '15': 304, '25': 126, '125': 364,
         '35': 174, '135': 423, '235': 224, '1235': 352, '45': 333, '145': 481, '245': 408, '1245': 367, '345': 461,
         '1345': 626, '2345': 403, '12345': 642, '6': 160, '16': 190, '26': 300, '126': 315, '36': 168, '136': 499,
         '236': 418, '1236': 556, '46': 277, '146': 496, '246': 472, '1246': 423, '346': 329, '1346': 493, '2346': 616,
         '12346': 574, '56': 357, '156': 506, '256': 275, '1256': 408, '356': 501, '1356': 609, '2356': 388,
         '12356': 667, '456': 324, '1456': 452, '2456': 466, '12456': 689, '3456': 611, '13456': 734, '23456': 696,
         '123456': 860, '7': 181, '17': 256, '27': 219, '127': 466, '37': 235, '137': 530, '237': 278, '1237': 428,
         '47': 395, '147': 551, '247': 357, '1247': 428, '347': 551, '1347': 515, '2347': 458, '12347': 538, '57': 180,
         '157': 506, '257': 319, '1257': 408, '357': 511, '1357': 613, '2357': 447, '12357': 711, '457': 558,
         '1457': 661, '2457': 456, '12457': 716, '3457': 516, '13457': 637, '23457': 754, '123457': 689, '67': 438,
         '167': 364, '267': 348, '1267': 451, '367': 376, '1367': 636, '2367': 442, '12367': 547, '467': 387,
         '1467': 702, '2467': 473, '12467': 810, '3467': 698, '13467': 819, '23467': 601, '123467': 712, '567': 547,
         '1567': 703, '2567': 484, '12567': 766, '3567': 474, '13567': 603, '23567': 554, '123567': 691, '4567': 523,
         '14567': 646, '24567': 771, '124567': 725, '34567': 824, '134567': 912, '234567': 750, '1234567': 863,
         '8': 106, '18': 301, '28': 290, '128': 199, '38': 157, '138': 257, '238': 415, '1238': 346, '48': 213,
         '148': 457, '248': 395, '1248': 387, '348': 424, '1348': 408, '2348': 347, '12348': 468, '58': 121, '158': 389,
         '258': 419, '1258': 507, '358': 283, '1358': 346, '2358': 357, '12358': 600, '458': 471, '1458': 552,
         '2458': 530, '12458': 630, '3458': 402, '13458': 538, '23458': 508, '123458': 786, '68': 374, '168': 315,
         '268': 420, '1268': 543, '368': 269, '1368': 407, '2368': 414, '12368': 676, '468': 491, '1468': 646,
         '2468': 585, '12468': 749, '3468': 641, '13468': 540, '23468': 691, '123468': 852, '568': 303, '1568': 408,
         '2568': 542, '12568': 643, '3568': 430, '13568': 680, '23568': 463, '123568': 809, '4568': 608, '14568': 566,
         '24568': 535, '124568': 788, '34568': 731, '134568': 857, '234568': 803, '1234568': 906, '78': 341, '178': 526,
         '278': 247, '1278': 438, '378': 329, '1378': 628, '2378': 358, '12378': 696, '478': 369, '1478': 631,
         '2478': 444, '12478': 563, '3478': 639, '13478': 628, '23478': 682, '123478': 720, '578': 515, '1578': 467,
         '2578': 591, '12578': 712, '3578': 562, '13578': 567, '23578': 515, '123578': 818, '4578': 487, '14578': 602,
         '24578': 550, '124578': 727, '34578': 563, '134578': 904, '234578': 816, '1234578': 994, '678': 563,
         '1678': 454, '2678': 618, '12678': 599, '3678': 483, '13678': 731, '23678': 703, '123678': 698, '4678': 676,
         '14678': 771, '24678': 568, '124678': 878, '34678': 597, '134678': 755, '234678': 755, '1234678': 996,
         '5678': 680, '15678': 773, '25678': 569, '125678': 833, '35678': 612, '135678': 711, '235678': 833,
         '1235678': 808, '45678': 654, '145678': 750, '245678': 687, '1245678': 823, '345678': 736, '1345678': 901,
         '2345678': 962, '12345678': 1081, '9': 187, '19': 374, '29': 324, '129': 341, '39': 208, '139': 510,
         '239': 335, '1239': 426, '49': 269, '149': 528, '249': 322, '1249': 441, '349': 338, '1349': 467, '2349': 475,
         '12349': 595, '59': 215, '159': 512, '259': 281, '1259': 391, '359': 455, '1359': 473, '2359': 438,
         '12359': 566, '459': 537, '1459': 502, '2459': 496, '12459': 566, '3459': 468, '13459': 626, '23459': 764,
         '123459': 830, '69': 389, '169': 375, '269': 530, '1269': 445, '369': 385, '1369': 484, '2369': 468,
         '12369': 570, '469': 576, '1469': 747, '2469': 507, '12469': 615, '3469': 505, '13469': 823, '23469': 602,
         '123469': 778, '569': 414, '1569': 496, '2569': 663, '12569': 739, '3569': 681, '13569': 606, '23569': 580,
         '123569': 885, '4569': 713, '14569': 810, '24569': 754, '124569': 764, '34569': 666, '134569': 919,
         '234569': 916, '1234569': 834, '79': 316, '179': 551, '279': 389, '1279': 660, '379': 553, '1379': 512,
         '2379': 624, '12379': 795, '479': 638, '1479': 748, '2479': 657, '12479': 656, '3479': 727, '13479': 839,
         '23479': 596, '123479': 774, '579': 585, '1579': 539, '2579': 459, '12579': 636, '3579': 689, '13579': 611,
         '23579': 565, '123579': 739, '4579': 757, '14579': 887, '24579': 679, '124579': 759, '34579': 838,
         '134579': 996, '234579': 728, '1234579': 864, '679': 574, '1679': 773, '2679': 649, '12679': 661, '3679': 741,
         '13679': 866, '23679': 761, '123679': 786, '4679': 786, '14679': 727, '24679': 725, '124679': 820,
         '34679': 748, '134679': 1015, '234679': 835, '1234679': 906, '5679': 577, '15679': 871, '25679': 652,
         '125679': 938, '35679': 681, '135679': 836, '235679': 750, '1235679': 861, '45679': 739, '145679': 854,
         '245679': 802, '1245679': 894, '345679': 825, '1345679': 1083, '2345679': 1106, '12345679': 1059, '89': 222,
         '189': 306, '289': 430, '1289': 419, '389': 350, '1389': 475, '2389': 382, '12389': 487, '489': 506,
         '1489': 457, '2489': 598, '12489': 587, '3489': 514, '13489': 636, '23489': 529, '123489': 859, '589': 490,
         '1589': 490, '2589': 432, '12589': 732, '3589': 405, '13589': 567, '23589': 717, '123589': 810, '4589': 683,
         '14589': 604, '24589': 738, '124589': 698, '34589': 788, '134589': 746, '234589': 711, '1234589': 950,
         '689': 371, '1689': 488, '2689': 581, '12689': 773, '3689': 449, '13689': 573, '23689': 739, '123689': 666,
         '4689': 511, '14689': 635, '24689': 733, '124689': 927, '34689': 805, '134689': 888, '234689': 857,
         '1234689': 987, '5689': 652, '15689': 759, '25689': 759, '125689': 823, '35689': 630, '135689': 708,
         '235689': 684, '1235689': 790, '45689': 773, '145689': 899, '245689': 712, '1245689': 1018, '345689': 799,
         '1345689': 895, '2345689': 853, '12345689': 1135, '789': 431, '1789': 548, '2789': 643, '12789': 738,
         '3789': 636, '13789': 654, '23789': 585, '123789': 834, '4789': 566, '14789': 642, '24789': 810, '124789': 729,
         '34789': 646, '134789': 779, '234789': 867, '1234789': 863, '5789': 692, '15789': 612, '25789': 764,
         '125789': 859, '35789': 809, '135789': 866, '235789': 699, '1235789': 801, '45789': 860, '145789': 783,
         '245789': 886, '1245789': 1050, '345789': 767, '1345789': 939, '2345789': 851, '12345789': 1112, '6789': 557,
         '16789': 873, '26789': 767, '126789': 933, '36789': 831, '136789': 983, '236789': 888, '1236789': 831,
         '46789': 843, '146789': 967, '246789': 934, '1246789': 908, '346789': 784, '1346789': 1132, '2346789': 917,
         '12346789': 1201, '56789': 654, '156789': 938, '256789': 773, '1256789': 898, '356789': 944, '1356789': 1090,
         '2356789': 842, '12356789': 972, '456789': 796, '1456789': 1121, '2456789': 1061, '12456789': 1223,
         '3456789': 1097, '13456789': 1101, '23456789': 1170, '123456789': 1302}, 10
    )

    end = time.time()
    print(end - start)

    print(test, test4, test5, test6, test7, test8, test9)
